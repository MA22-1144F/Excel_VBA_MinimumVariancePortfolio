# Excel_VBA_MinimumVariancePortfolio

## 概要
Excel上で株価データから最小分散フロンティアを作図します。  
ExcelのSolverアドインを使用します。

<img src="images/image_01.png" alt="フォームイメージ" width="300">
<img src="images/image_02.png" alt="グラフメージ" width="600">

## 動作環境
Microsoft Excel上で動作します。  

## インストール方法
1. Contentsフォルダ内の frmMVP.frm、frmMVP.frx を任意の同一フォルダに保存
2. 任意のExcelBookをマクロ有効ブック(.xlsm)として保存
3. [ファイル]>[オプション]>[アドイン]>[設定]でソルバー アドインにチェックを入れて[OK]またはEnter
4. [開発タブ]またはAlt+F11でVisual Basicを開く
5. [ツール]>[参照設定]またはAlt+T+RからSlverにチェックを入れて[OK]またはEnter
6. [▶Sub/ユーザー フォームの実行]またはF5でユーザーフォームを実行

## 機能
任意の株価データ(行方向に期間、列方向に銘柄)から以下のものを計算・表示する。
* 銘柄毎のログリターン及びその平均、標準偏差(参照形式で表示)  
* 銘柄間の分散共分散行列(参照形式で表示)  
* ポートフォリオの期待利益率を実現する最小の標準偏差及びその時の各銘柄への投資割合  
* 最小分散フロンティのグラフ  
* 縦軸：期待利益率、横軸：投資割合で各銘柄への投資割合の推移を表したグラフ

## フォームの説明
株価Sheet名：分析したい株価情報が記録されているSheet名を入力してください。  
新規Sheet名：分析結果を表示するSheet名を入力してください(Sheetが自動で作成されます)。  
株価データ行・列：分析したい株価情報の範囲を指定してください(範囲が広いほど処理に時間がかかります)。  
 * 株価の部分のみ指定し、会社名や証券コード、期間などは含めないでください。  
 * 株価情報は行方向に期間、列方向に銘柄を羅列してください。  
 * 行の指定は半角数字、列の指定は大文字または小文字の半角英字で行ってください。  
銘柄名∨コード列：分析したい銘柄の名称またはコードの範囲を指定してください。  
 * 銘柄の名称またはコードは株価データと同一の行に記録してください。  
 * 列の指定は大文字または小文字の半角英字で行ってください。  
最低投資割合：各銘柄に投資する最低限の割合を0以上の半角数字で入力してください。  
 * 0を入力した場合は投資しない銘柄が生じる可能性があります｡  
期待利益率の段階：分析する期待利益率の細かさの程度を指定してください。  
 * 10程度でも十分な最小分散フロンティアの作図が可能です(数字が大きいほど処理に時間がかかります)。  
オプションボタン：どこまでの処理を実行するかを3段階で選択できます。  
 * {ログリターンまで}、{ポートフォリオ標準偏差まで}は比較的短時間で処理が終了します。  
 * {最終分散フロンティア作図まで}は処理に時間を要します。  
クリアボタン：入力欄をすべて空欄に戻します。  
実行ボタン：処理を実行します(入力欄を埋めるまでは押せません)。  

## 連絡先
[Instagram](https://www.instagram.com/nattotoasto?igsh=NWNtdHhnY3A4NDQ0 "nattotoasto")

## ライセンス
MIT License
